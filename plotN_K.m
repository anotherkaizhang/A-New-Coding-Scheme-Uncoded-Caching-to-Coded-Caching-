% comparing two schemes for caching

% function plotN_K(N,K)
N = 5; K = 11;
% Yu's scheme
close all;
linewidth =1;
t = 0 : K;
M = t*N/K;
minNK = min([N,K]);
R = zeros(1, length(t));
Rp = R;
for i=1:length(t)    
    Rp(i) = K*(1-M(i)/N)./(1+K*M(i)/N);
    if(K-minNK>=t(i)+1 && K>=t(i))
        R(i) = Rp(i)-nchoosek(K-minNK,t(i)+1)./nchoosek(K,t(i));
    else
        R(i) = Rp(i);
    end
end
%index = find(R<N);5
%plot(M(index),R(index),'mx--','LineWidth',2);
plot(M,R,'rx-','LineWidth',linewidth);
hold on;
%plot(M,Rp,'mo--','LineWidth',2);

display('Yu scheme');
display(M);
display(R);
% Tian's scheme
%R = N-M-M.*(N-M)*((N-1)*K/(N*N*(K-1)));
%plot(M,R,'bs-.','LineWidth',2)

%plot(R,M,'r')

% Tian'
display('Tian-Chen scheme')
if(N<=K)
    M = (t.*t*(N-1)+t*(K-N))/K/(K-1)
    R = N*(K-t)/K
    plot(M,R,'kd--','LineWidth',linewidth);
end
%display('Tian scheme points');
%display(M(end:-1:1));
%display(R(end:-1:1));

% for s=1:min([N,K])
%     for l=1:s
%         plot((N-l+1)/s,(s-1)/2+l*(l-1)/(2*s),'o');
%     end
% end


%Yu Thm4

% for n=max([K-N+1,1]):K-1
%     alpha = floor((N-1)/(K-n));
%     beta = N-alpha*(K-n);
%     if(K*beta+alpha*(K-n)*(K-n-1)/2<=n*(n+1)*alpha/2)
%         line([0,N*n*(2*K-n+1)/(K*(K+1))],[(2*K-n+1)/(n+1),0]);        
%     else
%         %line([0,(2*K-n+1)*n*(N-beta)/(2*K*(K-n))],[(2*K-n+1)/(n+1),0]);        
%     end
% end



% Gunduz
% plot((N-1)/K,N*(1-N/2/K),'rx','LineWidth',2);

%legend('Yu','Wan','Tian-Chen');

%h = line([1.5, 4/3, 5/6],[2/3,5/6,1.5]);
%set(h,'LineWidth',2,'Marker','x')
xlabel('M');
ylabel('R');

if(N==5&&K==11)    
    plot([0.4545    0.2273    0.1515    0.1136    0.0909],[3.6364    4.0909    4.3182    4.4545    4.5455],'b+-.') % Gomez-Vilardebo scheme
%     plot([1.5, 4/3, 5/6],[2/3,5/6,1.5],'ob-','LineWidth',linewidth) % Partial decomposition
    plot([0.254545454545455, 0.490909090909092, 0.581818181818184, 0.909090909090909],[4.090909090909091,3.527272727272724, 3.327272727272724, 2.636363636363636],'ob-','LineWidth',linewidth) % Partial decomposition
    
    
%     MR =[ 3   ,   0       ;
%         2.250000,   0.250000;
%         1.500000,   0.666667;
%         1.166648,   1.000019;
%         0.974545,   1.192727;
%         0.844444,   1.325926;
%         0.781260,   1.392351;
%         0.714288,   1.464284;
%         0.648149,   1.537036;
%         0.600000,   1.600000;
%         0.500000,   1.750000;
%         0.250000,   2.250000;
%         0       ,   3       ];   % Computer-generated outer bound
%     x = MR(:,1);
%     y = MR(:,2);
%     plot(x(1:end),y(1:end),'r:');    

    h=line([0.2273, 0.9091], [4.0909, 2.6364]); % corner point
    set(h,'LineStyle','-.','color','m');
    legend('Yu et al. scheme','Tian-Chen scheme','Gomez-Vilardebo scheme','Partial decomposition', 'Lower convex hull of known schemes', 'AutoUpdate','off')
    %legend('Yu et al. scheme','Tian-Chen scheme','Partial decomposition');
    ah = gca;
    % location of the plot to be zoomed in
    s_pos = [0.41,  3.21, 0.63, 3.72];
    % location of the zoom-in plot?
    t_pos = [1.5, 2.7, 3.3, 4.9];
    h=line([s_pos(1),t_pos(1)],[s_pos(4),t_pos(4)]);
    set(h,'LineStyle',':','color','k');
    h=line([s_pos(3),t_pos(3)],[s_pos(2),t_pos(2)]);
    set(h,'LineStyle',':','color','k');

    zoomPlot(ah, s_pos, t_pos);
else
    legend('Yu et al. scheme','Tian-Chen scheme');
end

if N==3&&K==9
    ah = gca;
    % location of the plot to be zoomed in
    s_pos = [0.4 1.55 0.8 2.1];
    % location of the zoom-in plot?
    t_pos = [1.5 1.2 2.3 2.3];
    h=line([s_pos(1),t_pos(1)],[s_pos(4),t_pos(4)]);
    set(h,'LineStyle',':','color','k');
    h=line([s_pos(3),t_pos(3)],[s_pos(2),t_pos(2)]);
    set(h,'LineStyle',':','color','k');
    zoomPlot(ah, s_pos, t_pos);
end

% (3,4) plot

% t=6 (M,R)=(51/95,14/5)
% t=7,(M,R)=(259/380,13/5) this should be chosen
% t=8 in AN scheme, (M,R)=(8/5,4/3)

% x1 = 51/95;
% y1 = 14/5;
% 
% x1 = 259/380;
% y1 = 13/5;
% 
% x2 = 8/5;
% y2 = 4/3;
% 
% C = (x2*y1-x1*y2)/(x2-x1)

% (N,K)=(3,6)
% MR = [3,0 ;
%     2.500000,  0.166667; 
%  2.000000,  0.400000 ;
%  1.500000,  0.750000 ;
%  1.423736,  0.816769 ;
%  1.421277,  0.818923 ;
%  1.420582,  0.819532 ;
%  1.417339,  0.822378 ;
%  1.416594,  0.823032 ;
%  1.416183,  0.823394 ;
%  1.411434,  0.827575 ;
%  1.410275,  0.828596 ;
%  1.409682,  0.829119 ;
%  1.409220,  0.829527 ;
%  1.407763,  0.830814 ;
%  1.407380,  0.831152 ;
%  1.407132,  0.831372 ;
%  1.405747,  0.832597 ;
%  1.405466,  0.832847 ;
%  1.404736,  0.833493 ;
%  1.404152,  0.834011 ;
%  1.404027,  0.834122 ;
%  1.403733,  0.834383 ;
%  1.400194,  0.837527 ;
%  1.399192,  0.838417 ;
%  1.398696,  0.838859 ;
%  1.398405,  0.839118 ;
%  1.397921,  0.839550 ;
%  1.397769,  0.839686 ;
%  1.397567,  0.839866 ;
%  1.392179,  0.844684 ;
%  1.390279,  0.846383 ;
%  1.390103,  0.846541 ;
%  1.389991,  0.846641 ;
%  1.389834,  0.846782 ;
%  1.389613,  0.846979 ;
%  1.389455,  0.847121 ;
%  1.388263,  0.848188 ;
%  1.387019,  0.849303 ;
%  1.385863,  0.850339 ;
%  1.363350,  0.870550 ;
%  1.360227,  0.873354 ;
%  1.358094,  0.875270 ;
%  1.357945,  0.875404 ;
%  1.357816,  0.875520 ;
%  1.357600,  0.875714 ;
%  1.356749,  0.876482 ;
%  1.352890,  0.879964 ;
%  1.352719,  0.880118 ;
%  1.349089,  0.883394 ;
%  1.343239,  0.888675 ;
%  1.342966,  0.888921 ;
%  1.336363,  0.894885 ;
%  1.336215,  0.895019 ;
%  1.335781,  0.895412 ;
%  1.334704,  0.896385 ;
%  1.332844,  0.898068 ;
%  1.332545,  0.898339 ;
%  1.322748,  0.907208 ;
%  1.316951,  0.912455 ;
%  1.316660,  0.912719 ;
%  1.315639,  0.913644 ;
%  1.314454,  0.914717 ;
%  1.313945,  0.915178 ;
%  1.312056,  0.916892 ;
%  1.311876,  0.917055 ;
%  1.308397,  0.920215 ;
%  1.308063,  0.920519 ;
%  1.303195,  0.924941 ;
%  1.302291,  0.925762 ;
%  1.302043,  0.925987 ;
%  1.301801,  0.926208 ;
%  1.301093,  0.926852 ;
%  1.300349,  0.927529 ;
%  1.300161,  0.927701 ;
%  1.299966,  0.927879 ;
%  1.299758,  0.928069 ;
%  1.299499,  0.928306 ;
%  1.298935,  0.928821 ;
%  1.298383,  0.929325 ;
%  1.297197,  0.930411 ;
%  1.295523,  0.931944 ;
%  1.295236,  0.932208 ;
%  1.294585,  0.932806 ;
%  1.293302,  0.933984 ;
%  1.292933,  0.934322 ;
%  1.290602,  0.936464 ;
%  1.277926,  0.948132 ;
%  1.277204,  0.948797 ;
%  1.274509,  0.951278 ;
%  1.267645,  0.957606 ;
%  1.267529,  0.957713 ;
%  1.250278,  0.973652 ;
%  1.250052,  0.973861 ;
%  1.249192,  0.974658 ;
%  1.248604,  0.975203 ;
%  1.247660,  0.976078 ;
%  1.243616,  0.979830 ;
%  1.243410,  0.980021 ;
%  1.242815,  0.980575 ;
%  1.242589,  0.980784 ;
%  1.242364,  0.980994 ;
%  1.242039,  0.981299 ;
%  1.241867,  0.981460 ;
%  1.241350,  0.981944 ;
%  1.239444,  0.983732 ;
%  1.237067,  0.985963 ;
%  1.235463,  0.987470 ;
%  1.234967,  0.987936 ;
%  1.234356,  0.988511 ;
%  1.232719,  0.990050 ;
%  1.226531,  0.995887 ;
%  1.219328,  1.002763 ;
%  1.219018,  1.003060 ;
%  1.216915,  1.005105 ;
%  1.188009,  1.033233 ;
%  1.187634,  1.033599 ;
%  1.187502,  1.033728 ;
%  1.187384,  1.033844 ;
%  1.187116,  1.034108 ;
%  1.186911,  1.034311 ;
%  1.186631,  1.034588 ;
%  1.186425,  1.034791 ;
%  1.186268,  1.034947 ;
%  1.184019,  1.037195 ;
%  1.039460,  1.181755 ;
%  1.039134,  1.182081 ;
%  1.038837,  1.182381 ;
%  1.036143,  1.185102 ;
%  1.034203,  1.187064 ;
%  1.033395,  1.187881 ;
%  1.033103,  1.188177 ;
%  1.032919,  1.188363 ;
%  1.032715,  1.188573 ;
%  1.029900,  1.191473 ;
%  1.012778,  1.209144 ;
%  0.979759,  1.243364 ;
%  0.939605,  1.284988 ;
%  0.931721,  1.293185 ;
%  0.930825,  1.294117 ;
%  0.929945,  1.295033 ;
%  0.929284,  1.295737 ;
%  0.929106,  1.295926 ;
%  0.928912,  1.296134 ;
%  0.922987,  1.302458 ;
%  0.922861,  1.302594 ;
%  0.853185,  1.377534 ;
%  0.839348,  1.392478 ;
%  0.838767,  1.393106 ;
%  0.838558,  1.393334 ;
%  0.834535,  1.397715 ;
%  0.813023,  1.421564 ;
%  0.812243,  1.422433 ;
%  0.811388,  1.423388 ;
%  0.811169,  1.423632 ;
%  0.810901,  1.423933 ;
%  0.810498,  1.424384 ;
%  0.810382,  1.424516 ;
%  0.802248,  1.433822 ;
%  0.801635,  1.434523 ;
%  0.744444,  1.500000 ;
%  0.732304,  1.514160 ;
%  0.728689,  1.518390 ;
%  0.728333,  1.518806 ;
%  0.725533,  1.522096 ;
%  0.720379,  1.528150 ;
%  0.716088,  1.533196 ;
%  0.714277,  1.535332 ;
%  0.713166,  1.536647 ;
%  0.713068,  1.536764 ;
%  0.712843,  1.537031 ;
%  0.712665,  1.537242 ;
%  0.711750,  1.538330 ;
%  0.710084,  1.540339 ;
%  0.709440,  1.541116 ;
%  0.709282,  1.541309 ;
%  0.709201,  1.541409 ;
%  0.709120,  1.541510 ;
%  0.708968,  1.541699 ;
%  0.708753,  1.541969 ;
%  0.708544,  1.542233 ;
%  0.708419,  1.542391 ;
%  0.707912,  1.543044 ;
%  0.706710,  1.544623 ;
%  0.704716,  1.547241 ;
%  0.704059,  1.548107 ;
%  0.703965,  1.548231 ;
%  0.703829,  1.548411 ;
%  0.702340,  1.550380 ;
%  0.702095,  1.550705 ;
%  0.698051,  1.556062 ;
%  0.697708,  1.556517 ;
%  0.697598,  1.556663 ;
%  0.697053,  1.557395 ;
%  0.679518,  1.581106 ;
%  0.663261,  1.603153 ;
%  0.635729,  1.640531 ;
%  0.635652,  1.640635 ;
%  0.635574,  1.640743 ;
%  0.635361,  1.641033 ;
%  0.634584,  1.642092 ;
%  0.634437,  1.642293 ;
%  0.634354,  1.642406 ;
%  0.631544,  1.646243 ;
%  0.631292,  1.646589 ;
%  0.628646,  1.650209 ;
%  0.626680,  1.652901 ;
%  0.621382,  1.660235 ;
%  0.621230,  1.660448 ;
%  0.620221,  1.661867 ;
%  0.619582,  1.662767 ;
%  0.616236,  1.667509 ;
%  0.612579,  1.672695 ;
%  0.609605,  1.676921 ;
%  0.599704,  1.691010 ;
%  0.597258,  1.694503 ;
%  0.597141,  1.694671 ;
%  0.597043,  1.694813 ;
%  0.596962,  1.694931 ;
%  0.596887,  1.695039 ;
%  0.596551,  1.695526 ;
%  0.596280,  1.695920 ;
%  0.595912,  1.696454 ;
%  0.587480,  1.708716 ;
%  0.581905,  1.716822 ;
%  0.576434,  1.724780 ;
%  0.566240,  1.739611 ;
%  0.566084,  1.739838 ;
%  0.565344,  1.740915 ;
%  0.560955,  1.747304 ;
%  0.560622,  1.747789 ;
%  0.560439,  1.748056 ;
%  0.560341,  1.748199 ;
%  0.552919,  1.759061 ;
%  0.539693,  1.778489 ;
%  0.535859,  1.784168 ;
%  0.531527,  1.790681 ;
%  0.531418,  1.790844 ;
%  0.523244,  1.803281 ;
%  0.454544,  1.909093 ;
%  0.449625,  1.916761 ;
%  0.449019,  1.917710 ;
%  0.437339,  1.937314 ;
%  0.422218,  1.962699 ;
%  0.418102,  1.969617 ;
%  0.417103,  1.971452 ;
%  0.408696,  1.986956 ;
%  0.408642,  1.987063 ;
%  0.399990,  2.004143 ;
%  0.381443,  2.041237 ;
%  0.333333,  2.142857 ;
%  0.166667,  2.500000 ;
%  0, 3];
% 
% x = MR(:,1);
% y = MR(:,2);
% plot(x,y,'r:','LineWidth',3);
% 
% 
%   MR=[3.000000   0.000000;
%   2.250000   0.250000;
%   1.500000   0.666666;
%   1.498561   0.668105;
%   1.166667   1.000000;
%   0.930556   1.237847;
%   0.837398   1.333333;
%   0.781250   1.392361;
%   0.714286   1.464286;
%   0.648148   1.537037;
%   0.600000   1.600000;                  
%   0.500000   1.750000;
%   0.250000   2.250000;                  
%   0.000000   3.000000]
% x = MR(:,1);
%  y = MR(:,2);
%  plot(x,y,'r:','LineWidth',3);

%g = 1:N;
%plot(N/K./g,N-N/K*(N+1)./(g+1),'kx-')

